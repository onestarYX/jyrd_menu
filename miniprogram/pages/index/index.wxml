<!--index.wxml-->

<!-- Template for menu table cell -->
<template name="menuCell">
  <view class="menuCell">
    <view>
      <cover-image class="avatar" src="../../images/小程序图标.jpeg">
      </cover-image>
    </view>

    <view class="itemDetailPanel">
      <text class="dishName">{{name}}</text>
      <text class="dishPrice">{{price}}</text>
    </view>

    <view class="addAmountPanel">
      <button id="decNumBtn" bindtap="decreAmount" data-index="{{index}}" data-array="{{array}}">-</button>
      <text id="amount">{{amount}}</text>
      <button id="addNumBtn" bindtap="increAmount" data-index="{{index}}" data-array="{{array}}">+</button>
    </view>

  </view>
</template>

<view class="container">

  <view class="title">
    <text>欢迎来到鸡鱼肉蛋用餐</text>

    <button id="testNav">我是商家</button>
  </view>

  <view class="menu">
    <scroll-view scroll-y="true" class="categoryList">
      <view wx:for="{{categoryList}}" class="categoryCell" bindtap="toggleCategory" data-index="{{index}}" hover-class="hover">
        <text bindtap="toggleCategory" data-index="{{index}}">{{item}}</text>
      </view>
    </scroll-view>

    <scroll-view scroll-y="true" class="menuTable">
      <!-- Here why is the getter not working? -->
      <template wx:if="{{currCategory == '特色菜'}}" wx:for="{{category1}}" is="menuCell" data="{{name: item.name, price: item.price, amount: item.amount, index: index, array: 'category1'}}"></template>
      
      <template wx:if="{{currCategory == '时令鲜蔬'}}" wx:for="{{category2}}" is="menuCell" data="{{name: item.name, price: item.price, amount: item.amount, index: index, array: 'category2'}}"></template>

      <template wx:if="{{currCategory == '主食'}}" wx:for="{{category3}}" is="menuCell" data="{{name: item.name, price: item.price, amount: item.amount, index: index, array: 'category3'}}"></template>
      <!-- Just for test and study -->
      <!--
      <view class="testView">
        <button class="testButton" id="id">
        </button>
      </view>
      <button class="testButton2"></button>
      -->
    </scroll-view>
  </view>

  <view class="shadow" wx:if="{{showCart}}" bindtap="hideModal"></view>

  <view class="cartItemList" wx:if="{{showCart}}" animation="{{animationData}}">
    <scroll-view scroll-y="true" class="cartScrollView">
      <template wx:for="{{cart}}" is="menuCell" data="{{name: item.name, price: item.price, amount: item.amount, index: index, array: 'cart'}}" ></template>
    </scroll-view>
  </view>

  <view class="cartPanel">
    <text id="cost">总价：{{cost}}</text>

    <button id="payBtn" bindtap="upload">确认订单</button>

    <button id="cart" bindtap="toggleCartPage">购物车</button>
  </view>



</view>
